<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>detectExcursion • actR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="detectExcursion">
<meta property="og:description" content="actR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">actR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/detectExcursion.html">detectExcursion</a>
    </li>
    <li>
      <a href="../articles/detectShift.html">detectShift</a>
    </li>
    <li>
      <a href="../articles/makeExcursion.html">Synthetic Data in  detectExcursion</a>
    </li>
    <li>
      <a href="../articles/makeShift.html">makeShift</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>detectExcursion</h1>
            
      
      
      <div class="hidden name"><code>detectExcursion.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="excursion-detection-in-actr">Excursion detection in actR<a class="anchor" aria-label="anchor" href="#excursion-detection-in-actr"></a>
</h2>
<p>This (in development) vignette will showcase a simple example of
detecting an excursion – defined in actR as a short term deviation from
a baseline – using the classic NGRIP d18O record. This dataset comes
preloaded in actR, and you can learn more about it with
<code><a href="../reference/ngrip.html">?ngrip</a></code>.</p>
<p>actR uses an excursion detection algorithm developed and used by <a href="https://cp.copernicus.org/articles/9/423/2013/cp-9-423-2013.pdf" class="external-link">Morrill
et al. (2013)</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">actR</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="excursion-detection-with-no-uncertainties">Excursion detection with no uncertainties<a class="anchor" aria-label="anchor" href="#excursion-detection-with-no-uncertainties"></a>
</h3>
<p>First, let’s take a look at the excursion in the NGRIP d18O dataset
near 8200 yr BP (the 8.2 ka event). First, we’ll tell it not to simulate
any uncertainties. We’re using the <code><a href="../reference/detectExcursion.html">detectExcursion()</a></code>
function, a high-level function for this approach.</p>
<p>We’ll need to give it some key parameters, in this case, we need to
define the center and width of the event window (8200 and 200 yr,
respectively). We also need to define the reference intervals (400 yrs
on each side), and how many standard deviations to use for the baseline
(sig.num = 2). We’re only looking for cold (negative excursions).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">excOutNoUnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectExcursion.html">detectExcursion</a></span><span class="op">(</span><span class="va">ngrip</span>, </span>
<span>                          vals.variable.name <span class="op">=</span> <span class="st">"d18O"</span>,</span>
<span>                          event.yr <span class="op">=</span> <span class="fl">8200</span>,</span>
<span>                          event.window <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                          ref.window <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                          sig.num <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                          exc.type <span class="op">=</span> <span class="st">"either"</span>,</span>
<span>                          n.ens <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          null.hypothesis.n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          simulate.time.uncertainty <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          simulate.paleo.uncertainty <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selected d18O</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Testing null hypothesis with 1 simulations, each with 1 ensemble members. </span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span></code></pre></div>
<p>After it runs, the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
functions will summarize the results.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">excOutNoUnc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">NGRIP.NGRIP.2004 - d18O: Excursion test results</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #555555;">Searched for </span><span style="color: #555555; font-weight: bold;">positive OR negative</span><span style="color: #555555;"> excursions in a </span><span style="color: #555555; font-weight: bold;">200</span><span style="color: #555555;"> year window around </span><span style="color: #555555; font-weight: bold;">8200</span><span style="color: #555555;"> BP, with reference windows of </span><span style="color: #555555; font-weight: bold;">400</span><span style="color: #555555;"> years on either side.</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Overall result: Empirical p-value = </span><span style="color: #00BB00; font-weight: bold;">0</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Time uncertainty considered? <span style="color: #BB0000;">FALSE</span></span></span>
<span><span class="co">#&gt; Paleo uncertainty considered? <span style="color: #BB0000;">FALSE</span></span></span>
<span><span class="co">#&gt; Error propagation ensemble members = 1</span></span>
<span><span class="co">#&gt; Null hypothesis testing ensemble members = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Parameter choices:</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #555555;">sig.num = 2</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; n.consecutive = 2</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; exc.type = either</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; min.vals = 4</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; na.rm = TRUE</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span></code></pre></div>
<p>Here we see the results, but it’s easier to see the results,
especially without uncertainties, as a plot:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">excOutNoUnc</span><span class="op">)</span></span></code></pre></div>
<p><img src="detectExcursion_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Here we see the baselines defined as red lines, with the excursions
and the points that exceed the threshhold as red dots. The method
requires a minimum number of consecutive points to pass the threshold,
the default is 2, this parameters is <code>n.consecutive</code>.</p>
</div>
<div class="section level3">
<h3 id="excursion-detection-with-d18o-uncertainties">Excursion detection with d18O uncertainties<a class="anchor" aria-label="anchor" href="#excursion-detection-with-d18o-uncertainties"></a>
</h3>
<p>So there’s clearly and excursion centered on 8.2 ka, but how much
might this be affected by uncertainty in the y-axis? In this case we’re
not really thinking of measurement error, but of the myriad
uncertainties that complicate the relationship between d18O and climate
(in this case, we’re thinking mostly of cooling). actR propagates these
uncertainties as ensembles, and works best if you pass a full ensemble
as input. However most datasets don’t have paleo ensembles, so actR will
simulate an ensemble based on an uncertainty estimate (0.2) and
uncertainty AR1 coefficient (0.8).</p>
<p>Now, because we’re working with ensembles, this will run multiple
times to propagate the error. We specify the number of error propagation
ensemble members in <code>n.ens</code>. To keep this vignette snappy,
we’re only using 50, but you probably want 100 or more.</p>
<p>We’re also going to take advantage of actR’s robust null hypothesis
testing, which will repeat the full analysis for synthetic data that
mirrors the characteristics of the input data. Check out this (TBD) to
learn more about null hypothesis testing in actR. We’ll also run the
null hypothesis simulation 50 times.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">excOutUncY</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectExcursion.html">detectExcursion</a></span><span class="op">(</span><span class="va">ngrip</span>, </span>
<span>                          vals.variable.name <span class="op">=</span> <span class="st">"d18O"</span>,</span>
<span>                          event.yr <span class="op">=</span> <span class="fl">8200</span>,</span>
<span>                          event.window <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                          ref.window <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                          exc.type <span class="op">=</span> <span class="st">"negative"</span>,</span>
<span>                          n.ens <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                          null.hypothesis.n <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                          simulate.time.uncertainty <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          simulate.paleo.uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          paleo.uncertainty <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                          paleo.ar1 <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selected d18O</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Testing null hypothesis with 50 simulations, each with 50 ensemble members. </span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■                              </span>   2% |  ETA:  1m</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■                            </span>  10% |  ETA: 45s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■                          </span>  16% |  ETA: 40s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■                        </span>  22% |  ETA: 37s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■                      </span>  30% |  ETA: 33s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■                    </span>  36% |  ETA: 30s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■                  </span>  42% |  ETA: 28s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■                 </span>  48% |  ETA: 24s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■              </span>  56% |  ETA: 20s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■            </span>  62% |  ETA: 18s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  68% |  ETA: 15s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■        </span>  76% |  ETA: 11s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■      </span>  82% |  ETA:  8s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■     </span>  88% |  ETA:  6s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  </span>  96% |  ETA:  2s</span></span></code></pre></div>
<p>This time, when we summarize the results, we get more interesting
output, including an empirical p-value, which is the fraction of null
hypothesis simulations that exceed the positivity rate in the actual
data. Typically, empirical p-values less than 0.05 are considered
significant.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">excOutUncY</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="font-weight: bold;">NGRIP.NGRIP.2004 - d18O: Excursion test results</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #555555;">Searched for </span><span style="color: #555555; font-weight: bold;">negative</span><span style="color: #555555;"> excursions in a </span><span style="color: #555555; font-weight: bold;">200</span><span style="color: #555555;"> year window around </span><span style="color: #555555; font-weight: bold;">8200</span><span style="color: #555555;"> BP, with reference windows of </span><span style="color: #555555; font-weight: bold;">400</span><span style="color: #555555;"> years on either side.</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Overall result: Empirical p-value = </span><span style="color: #BB0000; font-weight: bold;">0.0612244897959183</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Time uncertainty considered? <span style="color: #BB0000;">FALSE</span></span></span>
<span><span class="co">#&gt; Paleo uncertainty considered? <span style="color: #00BB00;">TRUE</span></span></span>
<span><span class="co">#&gt; Error propagation ensemble members = 50</span></span>
<span><span class="co">#&gt; Null hypothesis testing ensemble members = 50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Parameter choices:</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #555555;">sig.num = 2</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; n.consecutive = 2</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; exc.type = negative</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; min.vals = 4</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; na.rm = TRUE</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span></code></pre></div>
<p>We also get a bit more information when plotting with uncertainties.
This plotting routine will show the data with uncertainty bands in the
back, and a representative ensemble member illustrating the
excursion.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">excOutUncY</span><span class="op">)</span> </span></code></pre></div>
<p><img src="detectExcursion_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Including d18O uncertainty muddies the water a bit, but this feature
is still clearly robust to uncertainties in the paleo data. But what
about age uncertainty?</p>
</div>
<div class="section level3">
<h3 id="excursion-detection-with-d18o-uncertainties-and-age-uncertainty">Excursion detection with d18O uncertainties and age uncertainty<a class="anchor" aria-label="anchor" href="#excursion-detection-with-d18o-uncertainties-and-age-uncertainty"></a>
</h3>
<p>In addition to d18O uncertainty, age uncertainty has the potential to
obscure abrupt changes in datasets. When we’re testing an excursion to
see if it’s robust to age uncertainty, we’re examining the likelihood
that, given age uncertainty, the excursion occurred during this specific
200 year window, NOT whether the excursion occurred at all. Age
uncertainty is unlikely to destroy an excursion this pronounced, but may
be able to move it from 8.2 to 8.5 ka.</p>
<p>Again, actR is designed to work with ensembles, so entering an age
ensemble in to <code><a href="../reference/detectExcursion.html">detectExcursion()</a></code> is ideal. But as is often
the case, this NGRIP dataset doesn’t come with ensembles. In this case,
actR can reasonably simulate age uncertainties (especially for layer
counted records) using BAM (Comboul et al. 2015). Here we’ll use BAM
with a Bernoulli model and symmetric 0.02 over/undercounting rates.</p>
<p>Once again, we’ll run all of this, including the age uncertainties,
through our robust null hypothesis testing.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">excOutUncXY</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectExcursion.html">detectExcursion</a></span><span class="op">(</span><span class="va">ngrip</span>, </span>
<span>                          vals.variable.name <span class="op">=</span> <span class="st">"d18O"</span>,</span>
<span>                          event.yr <span class="op">=</span> <span class="fl">8200</span>,</span>
<span>                          event.window <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                          ref.window <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                          exc.type <span class="op">=</span> <span class="st">"negative"</span>,</span>
<span>                          n.ens <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                          null.hypothesis.n <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                          simulate.time.uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          bam.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ns <span class="op">=</span> <span class="fl">50</span>, name <span class="op">=</span> <span class="st">"bernoulli"</span>, param <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>                          simulate.paleo.uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          paleo.uncertainty <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selected d18O</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Testing null hypothesis with 50 simulations, each with 50 ensemble members. </span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■                              </span>   4% |  ETA:  1m</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■                             </span>   8% |  ETA:  1m</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■                           </span>  14% |  ETA:  1m</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■                          </span>  18% |  ETA: 48s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■                        </span>  24% |  ETA: 44s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■                      </span>  30% |  ETA: 40s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■                     </span>  34% |  ETA: 38s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■                   </span>  40% |  ETA: 34s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■                  </span>  44% |  ETA: 32s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% |  ETA: 29s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■              </span>  56% |  ETA: 25s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■             </span>  60% |  ETA: 23s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  66% |  ETA: 20s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■         </span>  72% |  ETA: 16s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■        </span>  76% |  ETA: 14s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■      </span>  82% |  ETA: 10s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■     </span>  88% |  ETA:  7s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   </span>  92% |  ETA:  5s</span></span>
<span><span class="co">#&gt; Testing null hypothesis <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  </span>  98% |  ETA:  1s</span></span></code></pre></div>
<p>Let’s examine the result.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">excOutUncXY</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="font-weight: bold;">NGRIP.NGRIP.2004 - d18O: Excursion test results</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #555555;">Searched for </span><span style="color: #555555; font-weight: bold;">negative</span><span style="color: #555555;"> excursions in a </span><span style="color: #555555; font-weight: bold;">200</span><span style="color: #555555;"> year window around </span><span style="color: #555555; font-weight: bold;">8200</span><span style="color: #555555;"> BP, with reference windows of </span><span style="color: #555555; font-weight: bold;">400</span><span style="color: #555555;"> years on either side.</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Overall result: Empirical p-value = </span><span style="color: #00BB00; font-weight: bold;">0</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Time uncertainty considered? <span style="color: #00BB00;">TRUE</span></span></span>
<span><span class="co">#&gt; Paleo uncertainty considered? <span style="color: #00BB00;">TRUE</span></span></span>
<span><span class="co">#&gt; Error propagation ensemble members = 50</span></span>
<span><span class="co">#&gt; Null hypothesis testing ensemble members = 50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Parameter choices:</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #555555;">sig.num = 2</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; n.consecutive = 2</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; exc.type = negative</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; min.vals = 4</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; na.rm = TRUE</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span></code></pre></div>
<p>And plot the output.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">excOutUncXY</span><span class="op">)</span></span></code></pre></div>
<p><img src="detectExcursion_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Given these uncertainties, and all of our parametric choices, we rest
assured that this excursion is robust to our uncertainties.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas McKay, Julien Emile-Geay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
